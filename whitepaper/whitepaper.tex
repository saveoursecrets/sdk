\documentclass[a4paper,titlepage,oneside]{article}

% tt
\normalfont 
\usepackage[T1]{fontenc} 
\usepackage{setspace}
\usepackage{geometry} 
\usepackage[parfill]{parskip} 
\usepackage{graphicx} 
\usepackage{amssymb} 
\usepackage{epstopdf} 
\usepackage{makeidx}
\usepackage{showidx}
\usepackage{url} 
\usepackage{verbatim}
\usepackage{txfonts}
\usepackage{moreverb}
\usepackage{listings}
\usepackage{wallpaper}
\usepackage{fancyhdr}
\usepackage{hyperref}
\hypersetup{
colorlinks,
	linkcolor=blue,
	urlcolor=blue,
	bookmarks=true,
	bookmarksopen=true,
	pdffitwindow=true,
	pdftitle={Protocol for Web3 Secret Storage},
	pdfkeywords={invoice},
	pdfauthor={Muji}
}
\urlstyle{rm}
\pdfpagewidth=\paperwidth
\pdfpageheight=\paperheight

\renewcommand{\paragraph}{\small}
\title{Protocol for Web3 Secret Storage}
\author{Muji}

\makeindex

\begin{document} 
	
\fancyhead{}
\fancyfoot{}

\lhead{\textbf{\textsc{Protocol for Web3 Secret Storage}}}
\rhead{\textbf{\textsc{}}}
\lfoot{\thepage}
\rfoot{\textsc{Last updated \today}}

\title{Protocol for secret storage using threshold signatures for secrets recovery in the event of death}

\author{Muji}

\maketitle

\tableofcontents

\section{Abstract}
\paragraph{People need to store secrets safely. An average person needs to store login passwords for online services and possibly other secrets such as SSH keys, GPG keys or other secret data. Now with the advent of cryptocurrencies people require the ability to store private keys that may hold considerable value. Storing these secrets using a trusted third-party service is a common practice for non-technical people however this poses risks such as the service provider geting hacked or a malicious employee attacking your data. Modern service providers will design a protocol that ensures that data is only decrypted on the client device and the master password never leaves the client device which provides confidence that the service provider cannot access secrets even if they are compromised.}

\paragraph{This protection against the service provider poses a problem for secrets recovery in the case of death. If the service provider cannot decrypt the secrets then they cannot release those secrets to family members in the case of the owner's death.}

\paragraph{The ability to pass on our secrets to loved ones upon death is important not only for social media accounts that may need to be closed but also access to bank accounts, cryptocurrency assets and other secrets that may be required for inheritance.}

\paragraph{We aim to show that it is possible to protect secrets using modern cryptography that allows for a high-level of confidence that your secrets are safe while alive and allowing family members to recover those secrets in the event of death.}

\section{Design Goals}

\begin{itemize}
  \item Secure design
  \item Recovery mechanism in the event of death
  \item Zero metadata leakage
  \item Self-hosted vaults
  \item Allow for untrusted hosting provider
  \item Cross-platform client implementations
  \item Allow applications to manage secrets in a vault using public / private key cryptography
  \item Support multi-user access with ACLs configurable by the owner
\end{itemize}

\subsection{Secure Design}

\paragraph{The cryptography to protect the secrets will use the industry standard AES256-GCM\footnote{\href{https://doc.libsodium.org/secret-key_cryptography/aead/aes-256-gcm}{AES256-GCM}} block cipher to protect the data at rest and ensure it's integrity using AEAD\footnote{\href{https://en.wikipedia.org/wiki/Authenticated_encryption}{Authenticated Encryption}}.}

\subsection{Recovery Mechanism}

\paragraph{Using cryptographic signatures for authentication to a vault access to the encrypted secrets can be restricted to single-parties or a quorum of trusted family members using threshold signatures.}

\paragraph{A quorum that exceeds the threshold would be able to access the bytes for the encrypted secrets but would still need the master password to decrypt the secrets.}

\paragraph{By using threshold signatures as a recovery mechanism we can \emph{distribute the trust} across multiple family members and provide redundancy in the case of deaths in the recovery circle.}

\paragraph{We will look at the problem of providing access to the master password to a recovery circle later.}

\subsection{Meta Data}

\paragraph{An attacker that acquires the encrypted vault should not be able to determine any information about the contents via meta data. The implication is that any indexing for search purposes would need to be performed client-side.}

\subsection{Self-hosted}

\paragraph{Our philosophy is sovereign ownership of assets and data so the program should be designed for self-hosting first but allow for an untrusted service provider to host the vaults for non-technical people that don't want the burden of managing a hosted service.}

\subsection{Cross-platform}

\paragraph{People should be free to change their computing platforms without worrying about losing access to their self-hosted secrets so the client software should run on all the major platforms. Linux, MacOS, Windows, iOS, Android and the Web.}

\subsection{Integrations}

\paragraph{Owners of vaults should be able to allow third-party applications to manage secrets to provide interoperability with third-party programs. The secrets stored by third-party applications must be isolated by namespace.}

\section{Components}

Use a standard server/client architecture to separate responsibilities:

\begin{itemize}
  \item Server manages authentication and authorization to encrypted vaults
  \item Client implementations authenticate to the server to retrieve encrypted vaults; decryption is always performed client-side
\end{itemize}

\section{Authentication}

\paragraph{Each vault has a corresponding encrypted authentication map that contains the public keys of clients that may access the vault. The authentication map must be loaded by the server so it can determine who is allowed access but it may only be modified by the vault owner.}

\paragraph{The authentication map must be encrypted to prevent an attacker from modifying the map to assign a public key allowed to authenticate.}

\paragraph{When the server starts each vault will be in a locked state and the vault owner must \emph{unlock} the authentication map using BLS Threshold Decryption\footnote{\href{https://en.wikipedia.org/wiki/BLS_digital_signature}{BLS Digital Signatures}} enabled by key shares distributed between the server and the owner. The server will then store the decrypted authentication map in memory and in collaboration with the owner can provide a secure mechanism to modify the in-memory authentication map as well as the encrypted authentication map.}

\paragraph{Once a server has \emph{unlocked} the authentication map for a vault clients can authenticate by signing a challenge which when verified corresponds to a public key in the authentication map. Upon successful authentication the server will issue a JWT\footnote{\href{https://en.wikipedia.org/wiki/JSON_Web_Token}{JSON Web Token}} that will allow a client to retrieve the encrypted contents of the vault.}

\end{document}
